System.register(["./index-legacy-BzvznpU_.js","./index-legacy-QH22Qod0.js"],function(e,r){"use strict";var t,n,o,l,a,u,c,g,i,d,s,h,p,f,b,w,C,m,$,y,v,k,x,S,F,I,z,O,P,_,E,T,H,R,j,V,M,W,X,A,B,D,G,K,N;return{setters:[e=>{t=e.aQ,n=e.E,o=e.bo,l=e.q,a=e.S,u=e.a8,c=e.ao,g=e.aR,i=e.aS,d=e.bu,s=e.aT,h=e.aU,p=e.aW,f=e.aX,b=e.X,w=e.dK,C=e.ae,m=e.T,$=e.a1,y=e.bU,v=e.dL,k=e.b7,x=e.dM,S=e._,F=e.dN,I=e.aa,z=e.aE,O=e.aw,P=e.dO,_=e.a6,E=e.o,T=e.N,H=e.a7,R=e.G,j=e.A,V=e.bt,M=e.bg,W=e.al,X=e.bp,A=e.x,B=e.b9},e=>{D=e.o,G=e.E,K=e.G,N=e.H}],execute:function(){const r=w(),U=e("F",e=>{const[t,o]=b("/"),[l,a]=b(null);return e.handle?.({setPath:o,startCreateFolder:()=>{a(t())}}),n(C,{class:"folder-tree-box",w:"$full",overflowX:"auto",get children(){return n(r.Provider,{get value(){return{value:t,onChange:r=>{o(r),e.onChange(r)},autoOpen:e.autoOpen??!1,forceRoot:e.forceRoot??!1,showEmptyIcon:e.showEmptyIcon??!1,showHiddenFolder:e.showHiddenFolder??!0,creatingFolderPath:l,setCreatingFolderPath:a}},get children(){return n(q,{path:"/"})}})}})}),q=e=>{const{isHidePath:o}=y(),[l,u]=b(),{value:g,onChange:i,forceRoot:d,autoOpen:s,showEmptyIcon:h,showHiddenFolder:p,creatingFolderPath:f,setCreatingFolderPath:w}=v(r),[M,W]=k(()=>x(e.path,S(),d));let X=!1;const A=async(e=!1)=>{if(!e&&l()?.length)return;const r=await W();V(r,e=>{X=!0,u(e)},()=>{B()&&K()})},{isOpen:B,onToggle:K}=t(),N=()=>g()===e.path,U=F(e.path);return m(I(g,async e=>{s&&U(e)&&(B()||K(),X||A())})),m(()=>{f()===e.path&&(B()||K(),X||A())}),n(a,{get when(){return p||!(o(e.path)&&!U(g()))},get children(){return n(C,{get children(){return[n(c,{spacing:"$2",get children(){return[n(a,{get when(){return!M()},get fallback(){return n(P,{size:"sm",get color(){return O()}})},get children(){return n(a,{get when(){return!Boolean(h&&void 0!==l()&&!l()?.length)},get fallback(){return n(z,{get color(){return O()},as:G})},get children(){return n(z,{get color(){return O()},as:D,get transform(){return B()?"rotate(90deg)":"none"},transition:"transform 0.2s",cursor:"pointer",onClick:()=>{K(),B()&&A()}})}})}}),n(_,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return N()?"$info8":"transparent"},get _hover(){return{bgColor:N()?"$info8":T()}},onClick:()=>{i(e.path)},get children(){return $(()=>"/"===e.path)()?"root":E(e.path)}})]}}),n(a,{get when(){return B()},get children(){return n(H,{mt:"$1",pl:"$4",alignItems:"start",spacing:"$1",get children(){return[n(R,{get each(){return l()},children:r=>n(q,{get path(){return j(e.path,r.name)}})}),n(a,{get when(){return f()===e.path},get children(){return n(L,{get parentPath(){return e.path},onCancel:()=>w(null),onSuccess:e=>{w(null),i(e),A(!0)}})}})]}})}})]}})}})},L=e=>{const r=l(),[t,g]=b(""),[i,d]=k(M),s=async()=>{const n=t().trim();if(!n||i())return;const o=X(n);if(!o.valid)return void A.warning(r(`global.${o.error}`));const l=j(e.parentPath,n),a=await d(l);B(a,()=>{e.onSuccess(l)},()=>{e.onCancel()})};let h;return W(()=>{setTimeout(()=>{h?.focus(),h?.select()},0)}),n(c,{spacing:"$2",w:"$full",pl:"$4",alignItems:"center",get children(){return[n(z,{get color(){return O()},as:G}),n(o,{ref:e=>h=e,get value(){return t()},onInput:e=>g(e.currentTarget.value),get placeholder(){return r("home.toolbar.input_dir_name")},size:"sm",flex:"1",onKeyDown:r=>{"Enter"===r.key?(r.preventDefault(),s()):"Escape"===r.key&&e.onCancel()},onBlur:r=>{if(i())return;const n=r.relatedTarget;"true"!==n?.dataset.folderAction&&(t().trim()||e.onCancel())}}),n(a,{get when(){return!i()},get fallback(){return n(P,{size:"sm",get color(){return O()}})},get children(){return n(u,{get"aria-label"(){return r("global.ok")},size:"sm",variant:"ghost",rounded:"$md",p:"$1",color:"$success9",onClick:s,tabIndex:0,"data-folder-action":"true",get children(){return n(z,{as:K,boxSize:"$6"})}})}}),n(u,{get"aria-label"(){return r("global.cancel")},size:"sm",variant:"ghost",rounded:"$md",p:"$1",color:"$danger9",get onClick(){return e.onCancel},tabIndex:0,"data-folder-action":"true",get children(){return n(z,{as:N,boxSize:"$6"})}})]}})};e("M",e=>{const r=l(),[t,o]=b("/"),[d,w]=b();return m(()=>{e.opened&&d()?.setPath(t())}),"function"==typeof e.defaultValue?m(()=>{o(e.defaultValue())}):"string"==typeof e.defaultValue&&o(e.defaultValue),n(f,{size:"xl",blockScrollOnMount:!1,get opened(){return e.opened},get onClose(){return e.onClose},get children(){return[n(g,{}),n(i,{get children(){return[n(s,{w:"$full",css:{overflowWrap:"break-word"},get children(){return n(c,{w:"$full",justifyContent:"space-between",alignItems:"center",get children(){return[n(C,{css:{overflowWrap:"break-word"},get children(){return e.header}}),n(a,{get when(){return $(()=>!!e.headerSlot)()&&d()},get children(){return e.headerSlot(d())}})]}})}}),n(h,{get children(){return[$(()=>e.children),n(U,{onChange:o,handle:e=>w(e),autoOpen:!0})]}}),n(p,{display:"flex",w:"$full",gap:"$4",alignItems:"flex-end",justifyContent:"flex-end",get children(){return[n(a,{get when(){return e.footerSlot},get children(){return n(C,{mr:"auto",get children(){return e.footerSlot}})}}),n(c,{spacing:"$2",get children(){return[n(u,{get onClick(){return e.onClose},colorScheme:"neutral",get children(){return r("global.cancel")}}),n(u,{get loading(){return e.loading},onClick:()=>e.onSubmit?.(t()),get children(){return r("global.ok")}})]}})]}})]}})]}})}),e("a",e=>{const{isOpen:r,onOpen:b,onClose:w}=t(),C=l();return[n(c,{w:"$full",spacing:"$2",get children(){return[n(o,{get id(){return e.id},get value(){return e.value},onInput:r=>e.onChange(r.currentTarget.value),get readOnly(){return e.onlyFolder},get onClick(){return e.onlyFolder?b:()=>{}},get placeholder(){return C("global."+(e.onlyFolder?"choose_folder":"choose_or_input_path"))}}),n(a,{get when(){return!e.onlyFolder},get children(){return n(u,{onClick:b,get children(){return C("global.choose")}})}})]}}),n(f,{size:"xl",get opened(){return r()},onClose:w,get children(){return[n(g,{}),n(i,{get children(){return[n(d,{}),n(s,{get children(){return C("global.choose_folder")}}),n(h,{get children(){return n(U,{forceRoot:!0,get onChange(){return e.onChange}})}}),n(p,{get children(){return n(u,{onClick:w,get children(){return C("global.confirm")}})}})]}})]}})]})}}});
