import{ap as z,dE as j,X as u,b7 as d,bq as h,dF as U,dG as A,aQ as J,E as e,q as E,c1 as x,ao as D,aE as K,a7 as B,a6 as b,a1 as l,cD as k,cQ as Y,S as q,Q as G,a8 as i,aR as ee,aS as te,bu as re,aT as ne,aU as se,bW as ae,bo as H,aW as oe,aX as ie,bt as O,b9 as g,bE as F,bR as de}from"./index-Bl5KfUKm.js";import{G as le}from"./index-CSLMu7OW.js";import ce from"./Common-6lepzY2T.js";import{a as ue}from"./FolderTree-CHsUuiQU.js";import"./useTitle-COa73MJx.js";import"./index-C_xnhf0Z.js";import"./index-S6P6XS8L.js";import"./SettingItem-BYHwCQXr.js";import"./item_type-CyD6qwPS.js";import"./ResponsiveGrid-BWMI6qdJ.js";var ge=z('<svg width=1em height=1em viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-width=2><path stroke-dasharray=60 stroke-dashoffset=60 stroke-opacity=.3 d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill=freeze attributeName=stroke-dashoffset dur=1.3s values=60;0></animate></path><path stroke-dasharray=15 stroke-dashoffset=15 d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill=freeze attributeName=stroke-dashoffset dur=0.3s values=15;0></animate><animateTransform attributeName=transform dur=1.5s repeatCount=indefinite type=rotate values="0 12 12;360 12 12">'),he=z('<svg width=1em height=1em viewBox="0 0 24 24"><g stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path fill=currentColor fill-opacity=0 stroke-dasharray=60 stroke-dashoffset=60 d="M3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z"><animate fill=freeze attributeName=stroke-dashoffset dur=0.5s values=60;0></animate><animate fill=freeze attributeName=fill-opacity begin=0.8s dur=0.15s values=0;0.3></animate></path><path fill=none stroke-dasharray=14 stroke-dashoffset=14 d="M8 12L11 15L16 10"><animate fill=freeze attributeName=stroke-dashoffset begin=0.6s dur=0.2s values=14;0>');function pe(r){return(()=>{var s=ge();return j(s,r,!0,!0),s})()}function me(r){return(()=>{var s=he();return j(s,r,!0,!0),s})()}const fe=()=>{const r=E(),[s,v]=u(),[N,$]=d(()=>h.get("/admin/index/progress")),[p,m]=u(),f=t=>{p()&&clearTimeout(p()),m(t?window.setTimeout(a,5e3):void 0)},a=async()=>{const t=await $();O(t,o=>{v(o),f(!o.is_done)},(o,P)=>{f(P!==404)})};a();const[y,S]=d(U),R=async()=>{const t=await S();g(t),a()},[w,I]=d(()=>h.post("/admin/index/clear")),_=async()=>{const t=await I();g(t),a()},[T,L]=d(()=>h.post("/admin/index/stop")),M=async()=>{const t=await L();g(t),a()};let c,n;const[C,Q]=d(A),W=async()=>{let t=[];c.value&&(t=c.value.split("\n"));let o=20;n.value&&(o=parseInt(n.value));const P=await Q(t,o);g(P),a()},{isOpen:X,onOpen:V,onClose:Z}=J();return[e(x,{get children(){return r("indexes.index_header")}}),e(ce,{get group(){return le.INDEX}}),e(x,{get children(){return r("indexes.current")}}),e(q,{get when(){return s()},get children(){return e(D,{spacing:"$2",w:"fit-content",shadow:"$md",rounded:"$lg",get bg(){return G("","$neutral3")()},get children(){return[e(K,{boxSize:"$28",color:"$accent9",p:"$2",get as(){var t;return(t=s())!=null&&t.is_done?me:pe}}),e(B,{spacing:"$2",flex:"1",alignItems:"start",mr:"$2",get children(){return[e(b,{get children(){return[l(()=>r("indexes.obj_count")),":",e(k,{colorScheme:"info",ml:"$2",get children(){var t;return(t=s())==null?void 0:t.obj_count}})]}}),e(b,{get children(){return[l(()=>r("indexes.last_done_time")),":",e(k,{colorScheme:"accent",ml:"$2",get children(){return l(()=>!!s().last_done_time)()?Y(s().last_done_time):r("indexes.unknown")}})]}}),e(q,{get when(){var t;return(t=s())==null?void 0:t.error},get children(){return e(b,{css:{wordBreak:"break-all"},get children(){return[l(()=>r("indexes.error")),":",e(k,{colorScheme:"danger",ml:"$2",get children(){return s().error}})]}})}})]}})]}})}}),e(D,{spacing:"$2",get children(){return[e(i,{colorScheme:"accent",onClick:[a,void 0],get loading(){return N()},get children(){return r("global.refresh")}}),e(i,{colorScheme:"danger",onClick:[_,void 0],get loading(){return w()},get children(){return r("indexes.clear")}}),e(i,{colorScheme:"warning",onClick:[M,void 0],get loading(){return T()},get children(){return r("indexes.stop")}}),e(i,{onClick:[R,void 0],get loading(){return y()},get children(){var t;return r("indexes.".concat((t=s())!=null&&t.is_done?"rebuild":"build"))}})]}}),e(i,{onClick:V,get children(){return r("indexes.update")}}),e(ie,{get opened(){return X()},onClose:Z,get children(){return[e(ee,{}),e(te,{get children(){return[e(re,{}),e(ne,{get children(){return r("indexes.update")}}),e(se,{get children(){return[e(x,{get children(){return r("indexes.paths_to_update")}}),e(ae,{ref(t){var o=c;typeof o=="function"?o(t):c=t}}),e(x,{get children(){return r("indexes.max_depth")}}),e(H,{value:20,type:"number",ref(t){var o=n;typeof o=="function"?o(t):n=t}})]}}),e(oe,{get children(){return e(i,{onClick:[W,void 0],get loading(){return C()},get children(){return r("indexes.update")}})}})]}})]}})]},xe=()=>{const r=E(),[s,v]=u(),[N,$]=d(()=>h.get("/admin/scan/progress")),[p,m]=u(),f=n=>{p()&&clearTimeout(p()),m(n?window.setTimeout(a,5e3):void 0)},a=async()=>{const n=await $();O(n,C=>{v(C),f(!C.is_done)},()=>{f(!0)})};a();const[y,S]=d(()=>h.post("/admin/scan/stop")),R=async()=>{const n=await S();g(n),a()},[w,I]=u("/"),[_,T]=u(0),[L,M]=d(()=>h.post("/admin/scan/start",{path:w(),limit:_()})),c=async()=>{const n=await M();g(n),a()};return[e(x,{get children(){return r("indexes.scan_header")}}),e(q,{get when(){return s()},get children(){return e(B,{alignItems:"start",spacing:"$2",w:"fit-content",p:"$2",shadow:"$md",rounded:"$lg",get bg(){return G("","$neutral3")()},get children(){return[e(b,{get children(){return[l(()=>r("indexes.task_status")),":",e(k,{get colorScheme(){var n;return(n=s())!=null&&n.is_done?"accent":"success"},ml:"$2",get children(){return l(()=>{var n;return!!((n=s())!=null&&n.is_done)})()?r("indexes.idle"):r("indexes.running")}})]}}),e(b,{get children(){return[l(()=>r("indexes.obj_count")),":",e(k,{colorScheme:"info",ml:"$2",get children(){var n;return(n=s())==null?void 0:n.obj_count}})]}}),e(i,{colorScheme:"danger",onClick:R,get loading(){return y()},get disabled(){var n;return(n=s())==null?void 0:n.is_done},get children(){return r("indexes.stop")}})]}})}}),e(de,{w:"100%",display:"flex",flexDirection:"column",get children(){return[e(F,{display:"flex",alignItems:"center",get children(){return r("indexes.path_to_scan")}}),e(ue,{get value(){return w()},onChange:n=>I(n)}),e(F,{display:"flex",alignItems:"center",get children(){return r("indexes.rate_limit")}}),e(H,{type:"number",get value(){return _()},step:.1,onInput:n=>T(parseFloat(n.currentTarget.value))})]}}),e(i,{colorScheme:"info",onClick:c,get loading(){return L()},get children(){return r("indexes.start")}})]},Ie=()=>e(B,{spacing:"$2",w:"$full",alignItems:"start",get children(){return[e(fe,{}),e(xe,{})]}});export{Ie as default};
