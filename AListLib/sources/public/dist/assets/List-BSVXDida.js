import{bU as K,D as F,k as v,E as t,ao as j,S as h,dW as f,aY as I,aE as W,aI as P,aw as U,a6 as o,r as M,cF as G,cG as H,dC as N,ah as X,cE as Y,cQ as J,bT as z,N as _,a1 as w,am as q,X as k,T as $,a_ as Q,dX as V,dY as Z,dZ as S,F as b,q as p,al as ee,d_ as C,G as te,U as re,d$ as ne,a7 as ie}from"./index-Bl5KfUKm.js";import{b as ae}from"./style-C2-n-Tf3.js";import{n as se,t as O,u as le,s as oe}from"./storage-B8Wc9tdG.js";import{M as ce}from"./index-C_xnhf0Z.js";import{O as A,g as ue}from"./icon-DqPtjxiZ.js";import{I as R,u as D}from"./helper-BVeNNIE1.js";const n=[{name:"name",textAlign:"left",w:{"@initial":"76%","@md":"50%"}},{name:"size",textAlign:"right",w:{"@initial":"24%","@md":"17%"}},{name:"modified",textAlign:"right",w:{"@initial":0,"@md":"33%"}}],de=e=>{const{isHide:s}=K();if(s(e.obj))return null;const{setPathAs:g}=F(),{show:c}=ae({id:1}),{pushHref:m,to:u}=v(),{openWithDoubleClick:l,toggleWithClick:d,restoreSelectionCache:a}=D(),i=()=>M.list_item_filename_overflow;return t(q.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return t(j,{get classList(){return{selected:!!e.obj.selected}},class:"list-item viselect-item",get"data-index"(){return e.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",get _hover(){return{transform:"scale(1.01)",bgColor:_()}},as:ce,get href(){return e.obj.name},get cursor(){return l()||d()?"default":"pointer"},get bgColor(){return w(()=>!!e.obj.selected)()?_():void 0},"on:dblclick":()=>{l()&&(f(e.index,!0,!0),u(m(e.obj.name)))},"on:click":r=>{if(r.preventDefault(),!l()&&!(r.ctrlKey||r.metaKey||r.shiftKey)&&a()){if(d())return f(e.index,!e.obj.selected);u(m(e.obj.name))}},onMouseEnter:()=>{g(e.obj.name,e.obj.is_dir,!0)},onContextMenu:r=>{z(()=>{f(e.index,!0,!0)}),c(r,{props:e.obj})},get children(){return[t(j,{class:"name-box",spacing:"$1",get w(){return n[0].w},get children(){return[t(h,{get when(){return I()},get children(){return t(R,{"on:mousedown":r=>{r.stopPropagation()},"on:click":r=>{r.stopPropagation()},get checked(){return e.obj.selected},onChange:r=>{f(e.index,r.target.checked)}})}}),t(W,{class:"icon",boxSize:"$6",get color(){return U()},get as(){return ue(e.obj)},mr:"$1",get cursor(){return e.obj.type!==A.IMAGE?"inherit":"pointer"},"on:click":r=>{e.obj.type===A.IMAGE&&(r.ctrlKey||r.metaKey||r.shiftKey||a()&&(P.emit("gallery",e.obj.name),r.preventDefault(),r.stopPropagation()))}}),t(o,{class:"name",get css(){return{wordBreak:"break-all",whiteSpace:i()==="multi_line"?"unset":"nowrap","overflow-x":i()==="scrollable"?"auto":"hidden",textOverflow:i()==="ellipsis"?"ellipsis":"unset","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}}},get title(){return e.obj.name},get children(){return e.obj.name}})]}}),t(h,{get fallback(){return t(o,{class:"size",get w(){return n[1].w},get textAlign(){return n[1].textAlign},get children(){return Y(e.obj.size)}})},get when(){return oe(e.obj.mount_details)},get children(){return t(h,{get fallback(){return t(o,{class:"size",get w(){return n[1].w},get textAlign(){return n[1].textAlign},get children(){return O(e.obj.mount_details)}})},get when(){return!X("show_disk_usage_in_plain_text")},get children(){return t(G,{get w(){return n[1].w},class:"disk-usage-percentage",trackColor:"$info3",rounded:"$full",size:"md",get value(){return le(e.obj.mount_details)},get children(){return[t(H,{get color(){return se(e.obj.mount_details)?"$danger6":"$info6"},rounded:"$md"}),t(N,{class:"disk-usage-text",get children(){return O(e.obj.mount_details)}})]}})}})}}),t(o,{class:"modified",display:{"@initial":"none","@md":"inline"},get w(){return n[2].w},get textAlign(){return n[2].textAlign},get children(){return J(e.obj.modified)}})]}})}})},E="dir_sort_";function L(e,s){try{localStorage.setItem("".concat(E).concat(e),JSON.stringify(s))}catch(g){console.warn("failed to save sort config:",g)}}function T(e){try{const s=localStorage.getItem("".concat(E).concat(e));return s?JSON.parse(s):null}catch(s){return console.warn("failed to read sort config:",s),null}}const B=e=>{var a;const s=p(),{pathname:g}=v(),[c,m]=k(e.initialOrder),[u,l]=k((a=e.initialReverse)!=null?a:!1);$(()=>{var i;e.initialOrder!==void 0&&(m(e.initialOrder),l((i=e.initialReverse)!=null?i:!1))}),$(()=>{c()&&(L(g(),{orderBy:c(),reverse:u()}),e.sortCallback(c(),u()))});const d=i=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:i.textAlign,cursor:"pointer",onClick:()=>{i.name===c()?l(!u()):z(()=>{m(i.name),l(!1)})}});return t(j,{class:"title",w:"$full",p:"$2",get children(){return[t(j,{get w(){return n[0].w},spacing:"$1",get children(){return[t(h,{get when(){return w(()=>!e.disableCheckbox)()&&I()},get children(){return t(R,{get checked(){return Z()},get indeterminate(){return V()},onChange:i=>{Q(i.target.checked)}})}}),w(()=>w(()=>!!S())()?t(o,b(()=>d(n[0]),{get children(){return S()}})):t(o,b(()=>d(n[0]),{get children(){return s("home.obj.".concat(n[0].name))}})))]}}),t(o,b({get w(){return n[1].w}},()=>d(n[1]),{get children(){return s("home.obj.".concat(n[1].name))}})),t(o,b({get w(){return n[2].w}},()=>d(n[2]),{display:{"@initial":"none","@md":"inline"},get children(){return s("home.obj.".concat(n[2].name))}}))]}})},ge=()=>{const{pathname:e}=v(),[s,g]=k(),[c,m]=k(!1),{registerSelectContainer:u,captureContentMenu:l}=D();return u(),ee(()=>{const a=T(e());a&&(g(a.orderBy),m(a.reverse),C(a.orderBy,a.reverse))}),t(ie,{onDragOver:a=>{var r,y;const i=Array.from((y=(r=a.dataTransfer)==null?void 0:r.items)!=null?y:[]);for(let x=0;x<i.length;x++)if(i[x].kind==="file"){P.emit("tool","upload"),a.preventDefault();break}},"oncapture:contextmenu":l,class:"list viselect-container",w:"$full",spacing:"$1",get children(){return[t(B,{sortCallback:C,get initialOrder(){return s()},get initialReverse(){return c()}}),t(te,{get each(){return re.objs},children:(a,i)=>t(de,{obj:a,get index(){return i()}})}),t(h,{get when(){return M.show_count_msg==="visible"},get children(){return t(o,{size:"sm",color:"$neutral11",get children(){return ne()}})}})]}})},xe=Object.freeze(Object.defineProperty({__proto__:null,ListTitle:B,default:ge,loadSortState:T,saveSortState:L},Symbol.toStringTag,{value:"Module"}));export{B as L,xe as a,n as c};
