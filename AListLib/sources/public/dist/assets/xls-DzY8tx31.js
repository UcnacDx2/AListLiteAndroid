import{X as g,al as P,E as t,ae as R,S as v,ao as U,G as _,a8 as G,a1 as x,aN as H,as as M,q as X,ap as S,aV as f,cp as Y,ef as b,a2 as K,a0 as y,eg as O,cY as Q,U as Z}from"./index-Bl5KfUKm.js";import{V as ee,a as te}from"./index-BITHMkw5.js";var re=S('<div style=padding:20px;overflow:auto><table style="border-collapse:collapse;width:100%;background-color:white;box-shadow:0 2px 8px rgba(0,0,0,0.1)"><tbody>'),ne=S("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#ffffff;padding-top:50px>"),oe=S("<tr>"),ae=S('<td style="border:1px solid #ddd;padding:8px 12px;white-space:pre-wrap;word-break:break-word;min-width:100px">');const ie=()=>{const E=X(),[C,F]=g(!0),[$,j]=g(!1),[B,I]=g(!1),[p,T]=g([]),[V,W]=g(0);let w;const q=()=>new Promise((r,o)=>{if(window.ExcelJS){r();return}const l=document.getElementById("exceljs-script");if(l){l.addEventListener("load",()=>r()),l.addEventListener("error",()=>o(new y("Failed to load ExcelJS library")));return}const a=document.createElement("script");a.src="https://res.oplist.org.cn/exceljs/exceljs.min.js",a.id="exceljs-script",a.async=!0,a.onload=()=>r(),a.onerror=()=>o(new y("Failed to load ExcelJS library")),document.head.appendChild(a)}),A=async()=>{try{F(!0),j(!1),await q();const r=Z.raw_url,o=await fetch(r);if(!o.ok)throw new y("Failed to fetch Excel file");const l=await o.arrayBuffer(),a=new window.ExcelJS.Workbook;await a.xlsx.load(l);const m=[];a.worksheets.forEach(c=>{const h=[];c.eachRow((s,u)=>{const n=[];s.eachCell({includeEmpty:!0},(e,k)=>{let d="";e.value!==null&&e.value!==void 0&&(typeof e.value=="object"&&"text"in e.value?d=e.value.text:typeof e.value=="object"&&"result"in e.value?d=String(e.value.result):d=String(e.value));const i={};e.font&&(i.bold=e.font.bold,i.italic=e.font.italic),e.fill&&e.fill.fgColor&&(i.bgColor=e.fill.fgColor.argb),e.alignment&&(i.alignment=e.alignment.horizontal||"left"),n.push({value:d,style:i})}),h.push(n)}),m.push({name:c.name,rows:h})}),T(m),F(!1)}catch(r){console.error("Excel加载失败:",r),j(!0),F(!1)}},D=()=>{w&&(document.fullscreenElement?document.exitFullscreen().then(()=>{I(!1)}):w.requestFullscreen().then(()=>{I(!0)}))};return P(()=>{A()}),t(Q,{w:"$full",h:"70vh",pos:"relative",get children(){return[t(R,{pos:"absolute",top:"$2",left:"$2",right:"$2",zIndex:"10",display:"flex",justifyContent:"space-between",alignItems:"center",px:"$2",get children(){return[t(v,{get when(){return x(()=>!C()&&!$())()&&p().length>0},get children(){return t(U,{spacing:"$2",flexWrap:"wrap",get children(){return t(_,{get each(){return p()},children:(r,o)=>t(G,{size:"sm",get variant(){return V()===o()?"solid":"outline"},colorScheme:"primary",onClick:()=>W(o()),get children(){return r.name}})})}})}}),t(R,{opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return t(H,{withArrow:!0,get label(){return x(()=>!!B())()?E("home.preview.exit_fullscreen"):E("home.preview.fullscreen")},get children(){return t(M,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return x(()=>!!B())()?t(ee,{}):t(te,{})},onClick:D})}})}})]}}),(()=>{var r=ne(),o=w;return typeof o=="function"?O(o,r):w=r,f(r,t(v,{get when(){return x(()=>!C()&&!$())()&&p().length>0},get children(){var l=re(),a=l.firstChild,m=a.firstChild;return f(m,t(_,{get each(){var c;return((c=p()[V()])==null?void 0:c.rows)||[]},children:c=>(()=>{var h=oe();return f(h,t(_,{each:c,children:s=>(()=>{var u=ae();return f(u,()=>s.value),Y(n=>{var J,z,L,N;var e=(J=s.style)!=null&&J.bold?"bold":"normal",k=(z=s.style)!=null&&z.italic?"italic":"normal",d=(L=s.style)!=null&&L.bgColor?"#".concat(s.style.bgColor.slice(2)):"transparent",i=((N=s.style)==null?void 0:N.alignment)||"left";return e!==n.e&&b(u,"font-weight",n.e=e),k!==n.t&&b(u,"font-style",n.t=k),d!==n.a&&b(u,"background-color",n.a=d),i!==n.o&&b(u,"text-align",n.o=i),n},{e:void 0,t:void 0,a:void 0,o:void 0}),u})()})),h})()})),l}}),null),f(r,t(v,{get when(){return C()},get children(){return t(K,{})}}),null),f(r,t(v,{get when(){return $()},get children(){return t(y,{get msg(){return E("preview.failed_load_excel")},h:"70vh"})}}),null),r})()]}})};export{ie as default};
