import{X as p,al as S,an as $,E as t,ae as j,aN as C,as as k,a1 as x,q as L,ap as B,aV as y,S as F,a2 as V,a0 as i,cp as z,ef as P,eg as b,cY as R,U as D}from"./index-Bl5KfUKm.js";import{V as I,a as A}from"./index-BITHMkw5.js";var M=B("<div style=width:100%;height:100%;overflow:auto;position:relative;background:#f5f5f5><div id=docx-container style=width:100%;height:100%;padding:20px>");const U=()=>{const c=L(),[f,u]=p(!0),[h,g]=p(!1),[m,d]=p(!1);let a,s;const w=(e,r)=>new Promise((n,l)=>{if(document.getElementById(r)){n();return}const o=document.createElement("script");o.src=e,o.id=r,o.type="text/javascript",o.onload=()=>n(),o.onerror=()=>l(new i("Failed to load script: ".concat(e))),document.head.appendChild(o)}),E=async()=>{try{if(u(!0),g(!1),await w("https://unpkg.com/jszip/dist/jszip.min.js","jszip-script"),await w("https://res.oplist.org.cn/docxjs/dist/docx-preview.min.js","docx-preview-script"),!window.docx)throw new i("docx-preview library not loaded");const e=D.raw_url,r=await fetch(e);if(!r.ok)throw new i("Failed to fetch document file");const n=await r.blob();s&&(await window.docx.renderAsync(n,s,void 0,{className:"docx-preview-container",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!1,ignoreFonts:!1,breakPages:!0,ignoreLastRenderedPageBreak:!0,experimental:!1,trimXmlDeclaration:!0,useBase64URL:!1,useMathMLPolyfill:!1,renderChanges:!1,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0}),u(!1))}catch(e){console.error("DOCX初始化失败:",e),g(!0),u(!1)}},_=()=>{a&&(document.fullscreenElement?document.exitFullscreen().then(()=>{d(!1)}):a.requestFullscreen().then(()=>{d(!0)}))},v=()=>{document.fullscreenElement||d(!1)};return S(()=>{E(),document.addEventListener("fullscreenchange",v)}),$(()=>{document.removeEventListener("fullscreenchange",v)}),t(R,{w:"$full",h:"70vh",pos:"relative",get children(){return[t(j,{pos:"absolute",top:"$2",right:"$2",zIndex:"10",opacity:"0.7",transition:"opacity 0.2s",_hover:{opacity:"1"},get children(){return t(C,{withArrow:!0,get label(){return x(()=>!!m())()?c("home.preview.exit_fullscreen"):c("home.preview.fullscreen")},get children(){return t(k,{size:"sm",colorScheme:"neutral","aria-label":"Toggle Fullscreen",get icon(){return x(()=>!!m())()?t(I,{}):t(A,{})},onClick:_})}})}}),(()=>{var e=M(),r=e.firstChild,n=a;typeof n=="function"?b(n,e):a=e;var l=s;return typeof l=="function"?b(l,r):s=r,y(e,t(F,{get when(){return f()},get children(){return t(V,{})}}),null),y(e,t(F,{get when(){return h()},get children(){return t(i,{get msg(){return c("preview.failed_load_doc")},h:"70vh"})}}),null),z(o=>P(r,"display",f()||h()?"none":"block")),e})()]}})};export{U as default};
